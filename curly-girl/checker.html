<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ingredient Scanner | Curly Girl Wavy Girl UK</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
    <script>(function(){var t=localStorage.getItem('stackless-theme')||'light';document.documentElement.setAttribute('data-theme',t);})();</script>
</head>
<body>
  <a href="#main" class="skip-to-main">Skip to main content</a>
  <nav class="nav">
    <div class="nav-inner">
      <a href="index.html" class="nav-logo">
        <span class="nav-logo-icon">&#127754;</span>
        CurlMagic UK
      </a>
      <ul class="nav-links" id="navLinks">
        <li><a href="index.html">&#10024; Home</a></li>
        <li><a href="checker.html" class="active">&#128270; Scanner</a></li>
        <li><a href="products.html">&#128218; Products</a></li>
        <li><a href="quiz.html">&#9889; Quiz</a></li>
        <li><a href="faq.html">&#128172; FAQ</a></li>
        <li><a href="listen.html">&#127911; Listen</a></li>
      </ul>
      <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode"><span class="icon-sun"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><line x1="12" y1="2" x2="12" y2="4"/><line x1="12" y1="20" x2="12" y2="22"/><line x1="4.93" y1="4.93" x2="6.34" y2="6.34"/><line x1="17.66" y1="17.66" x2="19.07" y2="19.07"/><line x1="2" y1="12" x2="4" y2="12"/><line x1="20" y1="12" x2="22" y2="12"/><line x1="4.93" y1="19.07" x2="6.34" y2="17.66"/><line x1="17.66" y1="6.34" x2="19.07" y2="4.93"/></svg></span><span class="icon-moon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg></span></button>
      <button class="nav-toggle" onclick="toggleNav()" aria-label="Toggle menu">&#9776;</button>
    </div>
  </nav>

  <main id="main" class="container" style="padding-top:2rem; padding-bottom:3rem;">
    <section class="hero" style="padding-bottom:2rem;">
      <h1 style="font-size:clamp(2rem, 5vw, 3rem);">Ingredient <span class="highlight">Scanner</span></h1>
      <p>Paste your ingredient list below to check for CGM compatibility. Search our database of 330+ UK haircare products, including common non-CG brands.</p>
    </section>

    <section style="padding-top:0;">
      <div class="checker-wrap">
        <!-- Tab Bar -->
        <div class="checker-tabs">
          <button class="checker-tab active" data-tab="search" onclick="switchTab('search')">Search Product</button>
          <button class="checker-tab" data-tab="snap" onclick="switchTab('snap')">Snap Ingredients</button>
          <button class="checker-tab" data-tab="scan" onclick="switchTab('scan')">Scan Barcode</button>
        </div>

        <!-- Tab: Search Product -->
        <div class="tab-panel active" id="tab-search">
          <div class="card">
            <p class="text-muted mb-2">Type a product or brand name to check if it's Curly Girl approved.</p>
            <div class="search-box">
              <input type="text" class="search-input" id="productSearchInput" placeholder="e.g. XHC Banana, Shea Moisture, Cantu..." oninput="searchProducts()" autocomplete="off">
            </div>
            <div id="productSearchResults" class="product-results"></div>
          </div>
        </div>

        <!-- Tab: Snap Ingredients -->
        <div class="tab-panel" id="tab-snap">
          <div class="card">
            <div class="ocr-container">
              <p class="text-muted mb-2">Take a photo of the ingredient list on the back of your product. We'll read it and check every ingredient.</p>
              <input type="file" accept="image/*" capture="environment" id="ocrFileInput" class="ocr-file-input" onchange="handleOCRFile(this)">
              <button class="camera-btn" onclick="document.getElementById('ocrFileInput').click()">
                <span class="camera-btn-icon">&#128247;</span> Snap Ingredient List
              </button>
              <div class="ocr-preview" id="ocrPreview">
                <img id="ocrImagePreview" class="ocr-image-preview" alt="Photo preview">
              </div>
              <div class="ocr-progress" id="ocrProgress">
                <div class="ocr-progress-bar">
                  <div class="ocr-progress-fill" id="ocrProgressFill"></div>
                </div>
                <div class="ocr-progress-text" id="ocrProgressText">Loading OCR engine...</div>
              </div>
              <div class="ocr-review" id="ocrReview">
                <p class="text-muted mb-2" style="font-size:0.85rem; text-align:left;">Review the extracted text below. Fix any mistakes, then check the ingredients.</p>
                <textarea class="ocr-review-textarea" id="ocrReviewText" placeholder="Extracted ingredients will appear here..."></textarea>
                <div class="ocr-review-actions">
                  <button class="btn btn-primary btn-sm" onclick="checkOCRIngredients()" style="flex:1; border-radius:2rem;">&#128270; Check These Ingredients</button>
                  <button class="btn btn-secondary btn-sm" onclick="resetOCR()" style="border-radius:2rem;">Try Again</button>
                </div>
              </div>
              <div class="results-container" id="ocrResults" aria-live="polite"></div>
            </div>
          </div>
        </div>

        <!-- Tab: Scan Barcode -->
        <div class="tab-panel" id="tab-scan">
          <div class="card">
            <div class="barcode-container">
              <p class="text-muted mb-2">Scan the barcode on your product to look it up. Coverage is limited for UK haircare, so if your product isn't found, try Search or Snap instead.</p>
              <button class="camera-btn" id="barcodeScanBtn" onclick="startBarcodeScanner()">
                <span class="camera-btn-icon">&#128722;</span> Scan Barcode
              </button>
              <div class="barcode-scanner-box" id="barcodeScannerBox">
                <div id="barcodeReader" style="width:100%;"></div>
              </div>
              <div class="barcode-result" id="barcodeResult"></div>
            </div>
          </div>
        </div>

        <!-- Paste Ingredients -->
        <div class="card" style="margin-top:0.75rem;">
          <details id="pasteDetails">
            <summary class="paste-toggle">&#128203; Paste a full ingredient list instead</summary>
            <div class="paste-content">
              <p class="text-muted mb-2">Paste the ingredient list from the back of your product. We'll check each one.</p>
              <textarea class="checker-textarea" id="ingredientInput" placeholder="Water (Aqua), Cetearyl Alcohol, Dimethicone..."></textarea>
              <div class="checker-actions">
                <button class="btn btn-primary btn-sm" onclick="checkIngredients()" style="flex:1; border-radius:2rem;">&#128270; Run Analysis</button>
                <button class="btn btn-secondary btn-sm" onclick="clearChecker()" style="border-radius:2rem;">Clear</button>
                <a href="#" class="try-example-link" onclick="loadExample(); return false;">Try an example</a>
              </div>
            </div>
          </details>
        </div>
        <div class="results-container" id="results" aria-live="polite"></div>
      </div>
    </section>

    <!-- Individual Ingredient Search -->
    <section style="margin-top:2rem;">
      <div class="checker-wrap">
        <div class="card">
          <h3>&#128269; Search Individual Ingredients</h3>
          <p class="text-muted mb-2">Not sure about a specific ingredient? Search our database.</p>
          <div class="search-box">
            <input type="text" class="search-input" id="searchInput" placeholder="Start typing an ingredient name..." oninput="searchIngredients()">
          </div>
          <div class="search-results ingredient-list" id="searchResults"></div>
        </div>
      </div>
    </section>

    <!-- Info Box -->
    <div class="checker-wrap">
      <div class="info-box">
        <div class="info-box-icon">&#128161;</div>
        <div>
          <h5>Did you know?</h5>
          <p>Ingredients are listed by concentration. If a 'bad' ingredient is at the very end (after preservatives like Phenoxyethanol), it might be present in less than 1% and potentially less harmful. The strictest CGM followers avoid them entirely, though!</p>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer">
    <p>Built by <a href="../index.html">Stackless</a> &copy; 2026</p>
    <p class="disclaimer">This tool is for informational purposes only. Always patch test new products.</p>
  </footer>

  <script src="ingredients-data.js"></script>
  <script src="products-data.js"></script>
  <script src="app.js"></script>
</body>
</html>
